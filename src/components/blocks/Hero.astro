---
import { Picture } from "astro:assets";
import book from "../../assets/book.png";
import AnimationFade from "../animations/AnimationFade.astro";
import AnimationFadeY from "../animations/AnimationFadeY.astro";
import Container from "../Container.astro";
import Link from "../Link.astro";
import StarsSky from "../StarsSky.astro";
import Title from "../Title.astro";
---

<div class="overflow-hidden relative">
  <Container>
    <StarsSky />

    <div class="absolute inset-0 bg-cream/80 mix-blend-multiply"></div>

    <div class="mix-blend-multiply">
      <div
        class="bg-tan-light w-full h-screen absolute inset-0 z-0"
        style="clip-path: polygon(0 50%, 0% 100%, 90% 100%);"
        data-speed="0.6"
      >
      </div>

      <div
        class="bg-tan w-full h-screen absolute inset-0"
        style="clip-path: polygon(0 60%, 0% 100%, 80% 100%);"
        data-speed="0.8"
      >
      </div>
    </div>

    <div class="flex justify-stretch items-center">
      <div class="w-full h-screen flex flex-col justify-center pb-12">
        <div
          class="flex relative flex-col col-start-1 -col-end-1 text-indigo-dark"
        >
          <Title size="xxl" tag="h1">Il profumo</Title>

          <div class="ml-auto row-start-2 inline-flex flex-col">
            <div class="ml-auto -mb-8">
              <Title size="sm" tag="h2" className="leading-none"
                >di Berta Corvi</Title
              >
            </div>

            <Title size="xxl" tag="h1"
              >dell’<i class="text-blue-royal">Universo</i></Title
            >
          </div>

          <!-- <Book /> -->

          <div
            data-book-hover
            class="lg:absolute inset-y-0 lg:max-w-1/2 lg:translate-y-[40%] lg:translate-x-[5%] scale-[1.7]"
          >
            <Picture
              loading={"eager"}
              formats={["avif", "webp"]}
              src={book}
              alt={"Il profumo dell’Universo"}
              width={1600}
              height={1600}
            />
          </div>
        </div>

        <AnimationFadeY>
          <div class="flex flex-col gap-4 ml-auto lg:w-[422px]">
            <!-- <div class="flex items-center flex-wrap gap-4">
              <Button>Italiano</Button>
              <Button>English</Button>
              <Button>Français</Button>
            </div> -->

            <p class="text-indigo-dark leading-tight">
              C'è qualcosa che solo lei può sentire. C'è qualcosa che solo lui
              può spiegare. Lei è una giovane ragazza egiziana che deve fare i
              conti con una ferita del passato. Lui è Nassim Haramein, il Fisico
              che ha rivelato al mondo la Teoria del Tutto. In un viaggio
              all'insegna della scoperta dei misteri dell'antico Egitto i loro
              destini si incroceranno perché il Caso non esiste e il profumo
              dell'Universo reclama la sua voce.
            </p>

            <div>
              <Link href="https://www.amazon.it/dp/B0DK65H4MT" target="_blank"
                >Acquista su Amazon</Link
              >
            </div>
          </div>
        </AnimationFadeY>
      </div>
    </div>
  </Container>
</div>

<script>
  import gsap from "gsap";

  const book = document.querySelector("[data-book-hover]") as HTMLElement;
  const magnetoStrengthBook = 50;

  book.addEventListener("mousemove", (e) => {
    const event = e as MouseEvent;
    const boundBox = book.getBoundingClientRect();
    const newX =
      (event.clientX - boundBox.left) / (book as HTMLElement).offsetWidth - 0.5;
    const newY =
      (event.clientY - boundBox.top) / (book as HTMLElement).offsetHeight - 0.5;

    gsap.to(book, {
      x: newX * magnetoStrengthBook,
      y: newY * magnetoStrengthBook,
      duration: 4,
      ease: "power4.out",
    });
  });

  book.addEventListener("mouseleave", () => {
    gsap.to(book, {
      x: 0,
      y: 0,
      duration: 4,
      ease: "elastic.out",
    });
  });
</script>
